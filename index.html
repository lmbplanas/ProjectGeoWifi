<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Philippines Schools Internet Connectivity Monitor | DICT-DepED</title>
    
    <!-- External Dependencies -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body data-theme="light">
    <!-- Premium Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>Loading Philippines Schools Data</h2>
            <p>Initializing connectivity monitoring system...</p>
        </div>
    </div>

    <div class="app-container">
        <!-- Modern Navigation Bar -->
        <nav class="navbar">
            <div class="nav-brand">
                <div class="brand-icon">
                    <i class="fas fa-network-wired"></i>
                </div>
                <div class="brand-text">
                    <h1>ConnectEd Philippines</h1>
                    <span>School Connectivity Monitor</span>
                </div>
            </div>
            
            <div class="nav-center">
                <div class="status-indicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="dataStatus">Loading app...</span>
                </div>
            </div>
            
            <div class="nav-actions">
                <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                    <i class="fas fa-moon" id="themeIcon"></i>
                </button>
                
                <div class="nav-logos">
                    <div class="logo-item">
                        <img src="dict logo.png" alt="DICT" class="nav-logo">
                        <span>DICT</span>
                    </div>
                    <div class="logo-item">
                        <img src="deped logo.png" alt="DepED" class="nav-logo">
                        <span>DepED</span>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Premium Control Panel -->
        <div class="control-panel">
            <div class="control-section">
                <div class="upload-zone">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <label for="csvFile" class="upload-label">
                        <span>Upload Data File</span>
                        <small>CSV or Excel files supported</small>
                    </label>
                    <input type="file" id="csvFile" accept=".csv,.xlsx,.xls" class="upload-input" />
                </div>
            </div>
            
            <div class="filter-section">
                <div class="filter-group">
                    <label><i class="fas fa-map-marker-alt"></i> Region</label>
                    <select id="regionFilter" class="modern-select">
                        <option value="">All Regions</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label><i class="fas fa-wifi"></i> Connectivity</label>
                    <select id="connectivityFilter" class="modern-select">
                        <option value="">All Status</option>
                        <option value="online">Online</option>
                        <option value="offline">Offline</option>
                        <option value="limited">Limited</option>
                    </select>
                </div>
                
                <button id="viewToggle" class="toggle-btn">
                    <i class="fas fa-layer-group"></i>
                    <span>Cluster View</span>
                </button>
            </div>
        </div>
        
        <main>
            <div id="map"></div>
            <div class="sidebar">
                <div class="stats">
                    <h3>Connectivity Statistics</h3>
                    <div class="stat-item">
                        <span class="stat-label">Total Schools:</span>
                        <span id="totalSchools">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Online:</span>
                        <span id="onlineSchools" class="online">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Offline:</span>
                        <span id="offlineSchools" class="offline">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Limited:</span>
                        <span id="limitedSchools" class="limited">0</span>
                    </div>
                </div>
                
                <div class="legend">
                    <h3>Map Legend</h3>
                    <div id="clusterLegend">
                        <div class="legend-item">
                            <span class="marker online-marker"></span>
                            <span>Online</span>
                        </div>
                        <div class="legend-item">
                            <span class="marker offline-marker"></span>
                            <span>Offline</span>
                        </div>
                        <div class="legend-item">
                            <span class="marker limited-marker"></span>
                            <span>Limited Connectivity</span>
                        </div>
                        <div class="legend-info">
                            <p style="font-size: 0.8rem; margin-top: 0.5rem; color: #666;">
                                <strong>Smart Clustering:</strong><br>
                                • <strong>Pie charts</strong> for mixed connectivity areas<br>
                                • <strong>Single colors</strong> for dominant connectivity<br>
                                • <strong>Size</strong> indicates number of schools<br>
                                • <strong>Hover</strong> for detailed breakdown<br>
                                • <strong>Click</strong> to zoom and explore
                            </p>
                        </div>
                    </div>
                    <div id="heatmapLegend" style="display: none;">
                        <div class="legend-item">
                            <span class="density-marker" style="background: rgba(40, 167, 69, 0.5);"></span>
                            <span>High Online Density</span>
                        </div>
                        <div class="legend-item">
                            <span class="density-marker" style="background: rgba(255, 193, 7, 0.5);"></span>
                            <span>High Limited Density</span>
                        </div>
                        <div class="legend-item">
                            <span class="density-marker" style="background: rgba(220, 53, 69, 0.5);"></span>
                            <span>High Offline Density</span>
                        </div>
                        <div class="legend-info">
                            <p style="font-size: 0.8rem; margin-top: 0.5rem; color: #666;">
                                • Circle size = number of schools<br>
                                • Color = dominant connectivity type<br>
                                • Click circles for area breakdown
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="school-details">
                    <h3>School Details</h3>
                    <div id="schoolInfo">
                        <p>Click on a school marker to see details</p>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
        // Immediate test script
        console.log('HTML loaded, testing JavaScript...');
        document.getElementById('dataStatus').textContent = 'JavaScript loaded, initializing map...';
        document.getElementById('dataStatus').style.color = 'orange';
    </script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <script src="https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="app.js"></script>
</body>
</html>